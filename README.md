# PythonDataIES_project
ML model predicting the probability of providing a loan

## Project Intro/Objective
The project aims to build a machine learning model that predicts the probability of a customer being approved for a loan based on their specific characteristics. This model is designed to be used directly by the customer to assess their eligibility for a loan before they apply. By inputting their relevant data into the model, the customer will receive a personalized probability score indicating their likelihood of a loan approval. Based on a Kaggle dataset.

### Methods Used
* Data Visualization
* etc.

### Technologies
* Python
* Pandas, jupyter
* etc. 

## Project description

### Environment

The project environment is specified in 'MLproject' and 'conda.yaml'. A user can install the conda environment with all project dependencies by running 
```bash
conda env create -f conda.yaml
```
and activate it with
```bash
conda activate Loan_prediction
```

### Model training

The main python script for model training is 'train.py'. It can be run inside the terminal using command 
```bash
python train.py
```

Moreover, a user can select his or her own custom parameters for the models training. The parameters eligible for setting are 'max_iter', 'penalty', 'solver' and 'C' for the logistic regression, and 'n_estimators', 'max_leaf_nodes', 'criterion', and 'max_depth' for the random forest. Their enabled values, default values and definitions are identical with the sklearn package documentation
[Logistic_regression](https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html)
[Random forest](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomForestClassifier.html)

More information can be found inside the help using
```bash
python train.py -h
```

An exampel of a command generating logistic regression with maximum iterations set to 200 and random forest with criterion set to 'entropy', keeping other parameters in default, looks like
```bash
python train.py -logit--max_iter 200 -rf--criterion entropy
```

Model metrics for given parameters are displayed in the terminal after a command is completed. A user can find results of both models through the mlflow UI using the link generated by the following command 
```bash
mlflow ui 
```

After the logit and rf runs are completed, the best-performing model based on the selected metric (rmse,mae,r2) out of these two runs and all preceding ones inside the "Loan_prediction" experiment is selected. This model is then registered and set to production stage. Finally, the basic prediction is performed. The evaluation metric can be set using an argument "--metric", for example, choosing R2 would look like that
```bash
python train.py --metric r2
```

In addition to the model metrics and parameters, a user can find information about the experiment size, best model URI, registration process and prediction in the terminal.


### Server and web application

Once the best-performing model is registered, a user can proceed to creating a local server and web application. This is accomplished inside the 'app.py' script by running this command, no further arguments need to be specified
```bash
python app.py
```
Once a server is created, its http adress leading to the web form can be found in the console. After filling all of the arrays and clicking the button 'Predict', the prediction is generated reaching values {1,0} assigning receiving and not receiving a loan, respectively. 



## Needs to be done

Adding more comments and functions description + check the custom parameteres compatibility and ranges (some of them cannot be used with others, some are only positive,...) + add loggings to warn about wrong form of input parameters 

Hyperparameters tuning